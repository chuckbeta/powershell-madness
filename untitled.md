# Certificate Services Administration Internal

![cid:image007.jpg@01CE6DC0.830786A0](data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAoHBwkHBgoJCAkLCwoMDxkQDw4ODx4WFxIZJCAmJSMgIyIoLTkwKCo2KyIjMkQyNjs9QEBAJjBGS0U+Sjk/QD3/2wBDAQsLCw8NDx0QEB09KSMpPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT3/wAARCAAzAIwDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD2aikrF8Ta3daBp0l/DYC6t4VLS4k2so9hjmhK7sD0Nuisnwzr0XiTQrfUoU8sSg5QnJUg9K1TTatoxXForkf+E3luvFtzoOl6d9pltxl5TMFUevb3rrFJKAsMNjkUNNbgncdRSZpaQwopM0UALRSZooAWikzTJ5WigkkWNpGVSQi9WPoKAJKKwPC/ilPEkd0r2c1ldWsmyaCX7y+hreptW0YJ3FooopAFYHjhgPCN8p5DqqEeuWFb2a5rx/Ls8Mkf37iJPzYU47ilsc94RkPhLxpeeGpji0uwLizJ6Zxyo/z2rsfEmrHSNFlniG65fEVun96RuAP6/hXN/E7R5pdKt9asARfaU4lUr1KdxUug6ivjfU7XVAp+w2EY2qRgNcMPmP8AwEfzrSXve+QtPdMXwlpq6P8AFG5tCxaX7AHlc/xyE5Y/nXW3niZ5NbfR9Gthd3sS7p3dtsUA7bj6+1c9aNs+N92D/HZCofhtMYfFHiazu+L03HmEN1K/5xVTV/efYUdNDZ1PxbqPhmeFvEFhEbCZwn2u1csIyf7wNa2t+J7LRtPguG3XD3RC20MXLTMemP8AGqHxFWFvAmqefjaI8rn+9niuCzcabqXgKfUtywJEBl+isTxn8MUowUlcbk07HoF3qXia0s2vP7Ls5VUbmtkmPmAexxgmn6d4ti13w5LqWjwiWWLPmW8rbGQjqDXQ8E15l4JgKaz4xe2/48t7qpH3S3OcVMUmmNuxv6B4r1nxHpP9oWWk2wiLFQj3BDEjr2qWy8Zm/urjTFsTa61CNwtLlsLIPVWHWqfwn/5EeL/rvJ/Os3xUhufi14fjsubiJC0xXqqe/wCtVyrmaFd2udB4S8WT+JLm/guLJLOWyfy3iMmX3euMdKl0bXtS1m8vESxgjtraRohc+aWEjD+6Mcj1rl/G1tPoXjGy1HSZRBJq/wDoc/HHP8X1r0DTdPg0rTobO2XbFCu0e/qT7mpkklddQjd6HMR3Emi6+2l2Spea3qINzczynZGijgcDn6CtjRdU1G41K7sNVs0hlgVXSWJiySqfTPf2rJ8U+F08R3632kaibPWbD5PMQ8c8hWpPBHiPU7+9v9G16JF1KwxukTpIp6Ghq6ugTs7HZUUUVmaCGsDxF4VHiMolxqF1DAjK6xRYA3Doa6CihO2qE1cpQWDrpzWl1cPdB1Ks8gAJB+lQ6LoVvoGjR6dYZWJN2GPXJPWtOii4WORHgFV106yNXvft5G0ycYx6Y9Kuap4OtdR1GLU4J5rLU4ht+1QHBcejDoa6Kiq5mHKjnZfCh1GaFtb1CbUIoWDrAVCRlh0LAdav61oFh4g042WoQB4eqkcFD2KntWnRSuwsjm4/DF/HZCy/4SG8NsBt5RfM2+m/r+NW18NW9roX9laZI9jCc7njwXbPXJPc+tbNFF2FkcnpPgZtCtWtdM1q+hgZixQ7WwT1Iz0rU0bwzZaLNNcQh5bufma5mbdI/wCPYe1bFFDk2HKkczrvgtPEF/Dc3Wo3SfZ38yBI8ARt6+9b9pBJb2yRyztO6jBkYAFvyqeihttWCyMC78Mu2tyarp2ozWVzMgSZVUOkmOhKnv71Povh2DR7i6ujLJc3t2wM9xJ1bHQAdgPStiii7CyCiiikMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//Z)Certificate Services Administration Internal

Standard Operating Procedure

| Process Owner | Windows Server Processing and Support Team |
| :--- | :--- |
| Date Created: | 2015 |
| Date Last Updated: | 5/27/2021 |
| Version: | 2.1 |

**Disclosure Protection Notice**

This document is the property of NTT Data and contains confidential and/or proprietary information of NTT Data. It shall not be disclosed, duplicated, used, in whole or in part for any purpose other than internal use and distribution. Review of this material is considered acceptance of this Disclosure Protection Notice.

**Document Control**

This document is available in two forms: controlled and uncontrolled. The controlled master copy is maintained electronically and accessed by authorized users of the NTT Data network. Uncontrolled versions are all other electronic and printed copies of this document.

Document History

| Filename: | MDY\_NTT\_Data\_Certificate\_Services\_Administration\_Internal.docx |
| :--- | :--- |
| Archive Location: | NTT Data’s Moodys Policies SHARE site |

## Document Control

<table>
  <thead>
    <tr>
      <th style="text-align:left">Version</th>
      <th style="text-align:left">Date Changed</th>
      <th style="text-align:left">Completed By</th>
      <th style="text-align:left">Description of Changes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">1.00</td>
      <td style="text-align:left">11/20/2015</td>
      <td style="text-align:left">Andrei Popescu</td>
      <td style="text-align:left">Original</td>
    </tr>
    <tr>
      <td style="text-align:left">1.10</td>
      <td style="text-align:left">6/7/2015</td>
      <td style="text-align:left">Phil Zakrzewski</td>
      <td style="text-align:left">Made corrections to section &quot;5.2 Maintaining the PKI environments&quot;</td>
    </tr>
    <tr>
      <td style="text-align:left">2.0</td>
      <td style="text-align:left">2/7/2017</td>
      <td style="text-align:left">Phil Zakrzewski</td>
      <td style="text-align:left">
        <p>&#xB7; Document has been split into two.</p>
        <p>&#xB7; Internal document (this one): &#x201C;MDY_NTT_Data_Certificate_Services_Administration_Internal.docx&#x201D;</p>
        <p>&#xB7; DMZ document name: &#x201C;MDY_NTT_Data_Certificate_Services_Administration_DMZ.docx&#x201D;</p>
        <p>&#xB7; DMZ CA text was from this document</p>
        <p>&#xB7; SHA1 decom environment was removed.</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">2.0</td>
      <td style="text-align:left">6/21/2017</td>
      <td style="text-align:left">Phil Zakrzewski</td>
      <td style="text-align:left">&#xB7; Reviewed</td>
    </tr>
    <tr>
      <td style="text-align:left">2.0</td>
      <td style="text-align:left">07/05/2017</td>
      <td style="text-align:left">Charles Betancourt</td>
      <td style="text-align:left">Reviewed and accepted</td>
    </tr>
    <tr>
      <td style="text-align:left">2.1</td>
      <td style="text-align:left">12/1/2017</td>
      <td style="text-align:left">Phil Zakrzewski</td>
      <td style="text-align:left">Reviewed, updated monitoring section to reflect change to SCOM/ManageEngine.</td>
    </tr>
    <tr>
      <td style="text-align:left">2.1</td>
      <td style="text-align:left">05/16/2018</td>
      <td style="text-align:left">Pavit Singh Chandoke</td>
      <td style="text-align:left">Reviewed</td>
    </tr>
    <tr>
      <td style="text-align:left">2.1</td>
      <td style="text-align:left">05/27/2021</td>
      <td style="text-align:left">Anuj Narula</td>
      <td style="text-align:left">updated CA</td>
    </tr>
  </tbody>
</table>

Contents

[1 Audience]()

[1.1 Moody's Corporation]()

[1.2 Dell]()

[2 Introduction]()

[2.1 Current Certificate Services Infrastructure]()

[2.2 MOODYS.NET SHA1 PKI Implementation]()

[2.3 MOODYS.NET SHA256 PKI Implementation]()

[2.4 MCOZ.TLD PKI Implementation]()

[3 Roles and Responsibilities]()

[4 Certificate Services Administration]()

[4.1 Issuing a new certificate]()

[4.2 Revoking a certificate]()

[4.3 Publishing a new certificate template]()

[4.4 Removing a published certificate template]()

[5 Monitoring and maintenance of the PKI environments]()

[5.1 Monitoring the PKI environments]()

[5.2 Maintaining the PKI environments]()

[6 Additional Information]()

[6.1 Exceptions]()

[6.2 Modification Information and Contacts]()

[6.3 Cross-Reference and Related Documents and Policies]()

[6.4 Keywords]()

[6.5 Terms and Definitions]()

[6.6 Practice Change and Revision]()

[6.7 Continuous Improvement]()

## 1 Audience

The following teams and/or individuals are most likely to use the information in this document for the purposes of Certificate Services administration \(includes requesting and issuing new certificates, maintenance tasks, troubleshooting and recovery\).

### Moody's Corporation

Moody's Corporation Platform Systems Engineering.

### NTT Data

All NTT Data associates assigned to the Moody's account as Certificate Services admins.

## 2 Introduction

### Current Certificate Services Infrastructure

The current Certificate Services infrastructure comprises of two separate PKI chains in the environment. Both are Microsoft based PKI implementations following the same two tier model – each having a root CA and a subordinate CA.

One of these chains are implemented and integrated into the ad.moodys.net environment controlling certificates issued internally in the moodys.net AD forest. This document is dedicated to this environment.

There is an additional PKI chain deployed in the mcoz.tld AD environment.

### MOODYS.NET SHA1 PKI Implementation

Moody’s SHA1 implementation is decom as of 2/2017 and should no longer be used.

### MOODYS.NET SHA256 PKI Implementation

Moody’s SHA256 environment is based on Windows Server 2012 R2. Its Root CA is PTC-WBRTCERT702 and its subordinate issuing CA is PTC-WBISCERT702. The root CA is kept in an offline state and the enterprise issuing CA is online and integrated into ad.moodys.net.

<table>
  <thead>
    <tr>
      <th style="text-align:left"><b>Hostname</b>
      </th>
      <th style="text-align:left"><b>Domain Name</b>
      </th>
      <th style="text-align:left"><b>ADCS Role Service(s)</b>
      </th>
      <th style="text-align:left"><b>IP Address</b>
      </th>
      <th style="text-align:left"><b>Operating System</b>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">ptc-wbcrtapp701</td>
      <td style="text-align:left">AD.moodys.net</td>
      <td style="text-align:left">Certification Authority (CA)</td>
      <td style="text-align:left">10.13.156.34</td>
      <td style="text-align:left">Win2012 R2 STD</td>
    </tr>
    <tr>
      <td style="text-align:left">ptc-wbcrtapp701</td>
      <td style="text-align:left">AD.moodys.net</td>
      <td style="text-align:left">
        <p>Certification Authority (CA)</p>
        <p>CA Web Enrollment</p>
        <p>Online Responder</p>
      </td>
      <td style="text-align:left">10.13.156.35</td>
      <td style="text-align:left">Win2012 R2 STD</td>
    </tr>
    <tr>
      <td style="text-align:left">FTC-WBISCERT402</td>
      <td style="text-align:left">AD.moodys.net</td>
      <td style="text-align:left">ADCS Role Not Installed</td>
      <td style="text-align:left">10.14.156.5</td>
      <td style="text-align:left">Win2012 R2 STD</td>
    </tr>
  </tbody>
</table>

Table 9 - MOODYS.net SHA256 PKI Server Details

ptc-wbcrtapp701 is running with the CA ADCS role installed and ptc-wbcrtapp701 is running with the CA, CA Web Enrollment and Online Responder ADCS roles installed. The configuration for ptc-wbcrtapp701 is listed in the two tables below.

<table>
  <thead>
    <tr>
      <th style="text-align:left">Server Information</th>
      <th style="text-align:left">Setting</th>
      <th style="text-align:left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">
        <p><b>Offline Root CA</b>  <em>Hostname:</em>
        </p>
        <p>ptc-wbcrtapp701</p>
        <p><em>Active Directory Domain:</em>
        </p>
        <p>AD.moodys.net</p>
      </td>
      <td style="text-align:left">Server Role(s)</td>
      <td style="text-align:left">Active Directory Certificate Services</td>
    </tr>
    <tr>
      <td style="text-align:left">Role Service(s)</td>
      <td style="text-align:left">Certification Authority</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Setup Type</td>
      <td style="text-align:left">Enterprise</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">CA Type</td>
      <td style="text-align:left">Root CA</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Private Key</td>
      <td style="text-align:left">Create a new private key</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Cryptography for CA</td>
      <td style="text-align:left">
        <p>RSA#Microsoft Software Key Storage Provider</p>
        <p>Sha256</p>
        <p>4096</p>
      </td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">CA Name</td>
      <td style="text-align:left">ptc-wbcrtapp701</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Distinguished Name Suffix</td>
      <td style="text-align:left">&lt;blank&gt;</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Validity Period</td>
      <td style="text-align:left">20 Years</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Certificate Database Location</td>
      <td style="text-align:left">C:\Windows\System32\CertLog</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Certificate Log Location</td>
      <td style="text-align:left">C:\Windows\System32\CertLog</td>
      <td style="text-align:left"></td>
    </tr>
  </tbody>
</table>

Table 10 - Offline Root CA ADCS Settings

<table>
  <thead>
    <tr>
      <th style="text-align:left"><b>Setting</b>
      </th>
      <th style="text-align:left"><b>Configuration</b>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">DSConfigDN</td>
      <td style="text-align:left">CN=Configuration,DC=moodys,DC=net</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLPublicationURLs</td>
      <td style="text-align:left">
        <p>1:C:\Windows\system32\CertSrv\CertEnroll\%3%8%9.crl</p>
        <p>2:http://ptc-wbcrtapp701.ad.moodys.net/certenroll/%3%8%9.crl</p>
        <p>10:ldap:///CN=%7%8,CN=CDP,CN=Public Key Services,CN=Services,%6</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">CACertPublicationURLs</td>
      <td style="text-align:left">
        <p>1:C:\Windows\system32\CertSrv\CertEnroll\%1_%3%4.crt</p>
        <p>2:http://ptc-wbcrtapp701.ad.moodys.net/certenroll/%1_%3%4.crt</p>
        <p>2:ldap:///CN=%7,CN=AIA,CN=Public Key Services,CN=Services,%6</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">ValidityPeriodUnits</td>
      <td style="text-align:left">10</td>
    </tr>
    <tr>
      <td style="text-align:left">ValidityPeriod</td>
      <td style="text-align:left">Years</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLPeriodUnits</td>
      <td style="text-align:left">2</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLPeriod</td>
      <td style="text-align:left">Years</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLDeltaPeriodUnits</td>
      <td style="text-align:left">0 (Delta CRL Disabled)</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLDeltaPeriod</td>
      <td style="text-align:left">Hours</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLOverlapUnits</td>
      <td style="text-align:left">0</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLOverlapPeriod</td>
      <td style="text-align:left">Hours</td>
    </tr>
    <tr>
      <td style="text-align:left">AuditFilter</td>
      <td style="text-align:left">127</td>
    </tr>
  </tbody>
</table>

Table 11 - Offline Root CA Registry Configuration Settings

PTC-WBISCERT702 is the enterprise issuing CA in this chain which should be used when requesting certificates. The configuration for PTC-WBISCERT702 is listed in the two tables below.

<table>
  <thead>
    <tr>
      <th style="text-align:left">Server Information</th>
      <th style="text-align:left">Setting</th>
      <th style="text-align:left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">
        <p><b>Subordinate Enteprise CA</b>  <em>Hostname:</em>
        </p>
        <p>PTC-WBISCERT702</p>
        <p><em>Active Directory Domain:</em>
        </p>
        <p>AD.moodys.net</p>
      </td>
      <td style="text-align:left">Server Role(s)</td>
      <td style="text-align:left">
        <p>Active Directory Certificate Services</p>
        <p>Web Server (IIS)</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">Role Service(s)</td>
      <td style="text-align:left">
        <p>Certification Authority</p>
        <p>Certification Authority Web Enrollment</p>
        <p>Online Responder</p>
      </td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Additional Roles Required</td>
      <td style="text-align:left">Add</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Setup Type</td>
      <td style="text-align:left">Enterprise</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">CA Type</td>
      <td style="text-align:left">Subordinate CA</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Private Key</td>
      <td style="text-align:left">Create a new private key</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Cryptography for CA</td>
      <td style="text-align:left">
        <p>RSA#Microsoft Software Key Storage Provider</p>
        <p>Sha256</p>
        <p>4096</p>
      </td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">CA Name</td>
      <td style="text-align:left">PTC-WBISCERT702</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Distinguished Name Suffix</td>
      <td style="text-align:left">&lt;automatically populated&gt;</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Request certificate from a parent CA</td>
      <td style="text-align:left">Save a certificate request to file and manually send it later to a parent
        CA</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Certificate Database Location</td>
      <td style="text-align:left">C:\Windows\System32\CertLog</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Certificate Log Location</td>
      <td style="text-align:left">C:\Windows\System32\CertLog</td>
      <td style="text-align:left"></td>
    </tr>
  </tbody>
</table>

Table 12 – Enterprise Subordinate CA ADCS Settings

<table>
  <thead>
    <tr>
      <th style="text-align:left"><b>Setting</b>
      </th>
      <th style="text-align:left"><b>Configuration</b>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">DSConfigDN</td>
      <td style="text-align:left">CN=Configuration,DC=moodys,DC=net</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLPublicationURLs</td>
      <td style="text-align:left">
        <p>65:C:\Windows\system32\CertSrv\CertEnroll\%3%8%9.crl</p>
        <p>6:http://PTC-WBISCERT702.ad.moodys.net/certenroll/%3%8%9.crl</p>
        <p>79:ldap:///CN=%7%8,CN=%2,CN=CDP,CN=Public Key Services,CN=Services,%6</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">CACertPublicationURLs</td>
      <td style="text-align:left">
        <p>1:C:\Windows\system32\CertSrv\CertEnroll\%1_%3%4.crt</p>
        <p>2:http://PTC-WBISCERT702.ad.moodys.net/certenroll/%1_%3%4.crt</p>
        <p>2:ldap:///CN=%7,CN=AIA,CN=Public Key Services,CN=Services,%6</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">ValidityPeriodUnits</td>
      <td style="text-align:left">2</td>
    </tr>
    <tr>
      <td style="text-align:left">ValidityPeriod</td>
      <td style="text-align:left">Years</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLPeriodUnits</td>
      <td style="text-align:left">3</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLPeriod</td>
      <td style="text-align:left">Days</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLDeltaPeriodUnits</td>
      <td style="text-align:left">1</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLDeltaPeriod</td>
      <td style="text-align:left">Days</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLOverlapUnits</td>
      <td style="text-align:left">0</td>
    </tr>
    <tr>
      <td style="text-align:left">CRLOverlapPeriod</td>
      <td style="text-align:left">Hours</td>
    </tr>
    <tr>
      <td style="text-align:left">AuditFilter</td>
      <td style="text-align:left">127</td>
    </tr>
  </tbody>
</table>

Table 13 – Enterprise Subordinate CA Registry Configuration Settings

There is also a DR server provisioned for this PKI chain - FTC-WBISCERT402. This server doesn’t have any ADCS roles installed and it should be used only in a DR situation by recovering the data for the issuing CA in the chain.

<table>
  <thead>
    <tr>
      <th style="text-align:left">Server Information</th>
      <th style="text-align:left">Setting</th>
      <th style="text-align:left">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">
        <p><b>Cold-Standby PKI DR</b>  <em>Hostname:</em>
        </p>
        <p>ptc-wbcrtapp701</p>
        <p><em>Active Directory Domain:</em>
        </p>
        <p>AD.moodys.net</p>
      </td>
      <td style="text-align:left">Server Role(s)</td>
      <td style="text-align:left">None</td>
    </tr>
    <tr>
      <td style="text-align:left">Role Service(s)</td>
      <td style="text-align:left">None</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Additional Roles Required</td>
      <td style="text-align:left">N/A</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">Setup Type</td>
      <td style="text-align:left">N/A</td>
      <td style="text-align:left"></td>
    </tr>
    <tr>
      <td style="text-align:left">CA Type</td>
      <td style="text-align:left">N/A</td>
      <td style="text-align:left"></td>
    </tr>
  </tbody>
</table>

Table 14 - Cold-standby PKI DR Server Settings

The CAs in this chain are configured to use the SHA256 hashing algorithm.

## Roles and Responsibilities

Moody’s Platform Systems Engineering \(PSE\) will provide approval for any major changes or recovery actions which need to be taken for the Certificate Services infrastructure

The NTT Data associates which are granted Certificate Services admin privileges will be responsible for performing the processes described in this document

## Certificate Services Administration

The administration of the Certificate Services infrastructure encompasses the following areas: the process of issuing a new certificate and of revoking an issued certificate. These steps can be performed in the Certificate Authority GUI on the corresponding PKI chain issuing CA.

### Renewing a new certificate

Moody’s does not use the renewal method for certificates, instead a new certificate will be issued when a request is received and approved.

Upon receiving a request for a new certificate the following steps should be followed in order to issue the corresponding certificate based on the provided CSR.

1. A CSR \(Certificate Signing Request file\) file will be required to submit a request for a certificate. The CSR file can be opened with notepad.

2. Using Internet Explorer, connect to [https://ptc-wbcrtapp701/certsrv while logged into Moodys internal network and click on Request a certificate.](https://ptc-wbiscert702/certsrv)

3. Click on Submit a certificate request by using a base-64-encoded CMC.

4. Copy and paste the contents of the provided CSR file in the Base-64-encoded certificate request and choose the Certificate Template which should be used to generate the new certificate from drop-down box.

5. After clicking on Submit the certificate request will be placed into a Pending state waiting to be approved. An id for the request will also be provided.

6. Open a Certification Authority MMC either from a jump server or locally from the issuing CA and navigate to the Pending Requests node. Locate the corresponding request based on the provided id, right click the request and approve it.

7. Using the same MMC navigate to the Issued Certificates node and based on the Request id locate the corresponding issued certificate. Double click on the issued certificate and navigate to the Details tab. Click on the Copy to file option.

8. On the Certificate Export Wizard choose the option to export the certificate in a format of Base-64 encoded X.509 and provide a path to save it.

9. Save the certificate and email it to the requestor. Make sure to zip or rename the extension to txt so it doesn’t get blocked.

### Revoking a certificate

A certificate which has been issued can be revoked ahead of its expiration date if required. Upon receiving a request to revoke such a certificate follow these steps:

1. Open the certificate for which the request has been created and identify the issuing CA from which it has been generated. These details can be found by looking at the Issuer Property under the Details tab of the certificate.

2. Open a Certification Authority MMC either from a jump server or locally from the issuing CA and navigate to the Issued Certificates node. Locate the certificate either by sorting all the certificates by the Issued Common Name column or by filtering the view to match the Issued Common Name of the certificate.

3. Right click on the certificate and point to All Tasks – Revoke Certificate.

4. Choose the appropriate Reason code for the revocation and click on Yes.

5. Navigate to the Revoked Certificates node under the MMC and verify that the certificate you have just revoked is showing in the list.

6. Optionally if the revocation information is critical and needs to be made immediately available you can also publish a new CRL by right clicking on the Revoked Certificates node and point to All Tasks – Publish and then click on OK to publish a new CRL which will include the revoked certificate.

### Publishing a new certificate template

A certificate template represents the definition based on which certificates are issued in the environment from an issuing CA. Because the issuing CA in the environment are enterprise ones integrated into Active Directory the templates which are used are also stored within AD in the Configuration naming context - CN=Certificate Templates,CN=Public Key Services, CN=Services, CN=Configuration, DC=moodys,DC=net.

Currently the templates in the table below are being published from the issuing CA in the environment.

| Certificate Template Name | Validity Period | Renewal Period | Publish Cert in AD | Intended Purpose |
| :--- | :--- | :--- | :--- | :--- |
| Moodys Domain Controller Template SHA2 | 2 years | 6 weeks | No | Server Authentication, Client Authentication |
| Moody's SPLUNK Server SHA2 | 10 years | 6 weeks | No | Server Authentication |
| Moody’s SCOM 2012 R2 | 3 years | 6 weeks | No | Server Authentication, Client Authentication |
| Moody's XenMobile Template | 3 years | 6 weeks | No | Client Authentication, Secure Email, Encrypting File System |
| Moody's Internal Web server with private key | 3 years | 6 weeks | No | Server Authentication |
| Subordinate Certification Authority | 5 years | 6 weeks | N/A | &lt;All&gt; |
| Moody's Computer Code Signing Certificate | 3 years | 6 weeks | No | Code Signing |
| Moody's Computer Certificate Autoenroll 2008 SHA2 | 2 years | 6 weeks | No | Server Authentication, Client Authentication |
| Moody's Computer Certificate 2003 | 1 years | 6 weeks | No | Server Authentication, Client Authentication |
| Moody's Internal Web Server 2003 | 3 years | 6 weeks | No | Server Authentication |

Table 21 – Enterprise Subordinate CA Registry Configuration Settings

These templates are made available on the issuing CAs by publishing them under the Certificate Templates node in the Certification Authority MMC. By publishing a template you are effectively making it available for request in the environment from the issuing CA.

To publish a defined template the following steps would need to be performed.

1. Open the certificate authority MMC and connect to the issuing CA on which the template needs to be published from.

2. Navigate to the Certificate Templates node.

3. Right click on the Certificate Templates node and choose New – Certificate Template to Issue.

4. In the Enable Certificate Templates wizard choose the specific template which needs to be published and click OK.

Please note that in order for certificates to be issued based on the published template the security permissions for the template and for the issuing CA need to allow the right to request a certificate to the appropriate resources.

### Removing a published certificate template

To remove a defined template from being published the following steps would need to be performed.

1. Open the certificate authority MMC and connect to the issuing CA on which the template is currently published from.

2. Navigate to the Certificate Templates node.

3. Locate the certificate template which needs to be removed – right click on it and choose Delete.

Please note that these actions will not delete the certificate template from the AD container it is stored in – they will just remove the template from being published on the issuing CA on which the steps are applied.

## Monitoring and maintenance of the PKI environments

The monitoring and maintenance process described below ensures the consistency and health of the PKI environments described in earlier sections of this document.

### Monitoring the PKI environments

Monitoring of the CAs in the environment is performed with SCOM \(Microsoft Systems Center Operations Manager\) and ManageEngine. The root CA’s, which are being kept in an offline state are monitored via a custom ManageEngine alert which will trigger an incident if they are brought online without having a change in place.

Outside of the regular SCOM monitoring, custom alerts are defined that will trigger incidents based on the event ids mentioned below.

_Log: Security_

_Event type: Success \| Failure audits_

_Category: Object Access_

_Event ID: 4873,4874,4875,4878,4879,4880,4881,4882,4885,4890,4891,4892,4896,4897,4898_

_Severity of event ID: Sev3._

This works in conjunction with built in Microsoft CA monitoring to trigger alerts when actions which are audited are performed \(such as starting or stopping ADCS, modifying the auditing settings for the CA or its current configuration\).

### Maintaining the PKI environments

Regular maintenance is performed on the online enterprise issuing CA in the environment via two scheduled tasks.

<table>
  <thead>
    <tr>
      <th style="text-align:left">Server</th>
      <th style="text-align:left">Task Name</th>
      <th style="text-align:left">Service Account</th>
      <th style="text-align:left">Triggers</th>
      <th style="text-align:left">Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">ptc-wbcrtapp701</td>
      <td style="text-align:left">Delete Expired Certs</td>
      <td style="text-align:left">
        <p>MDYNYCMAS\</p>
        <p>Sys_DomMonitor</p>
      </td>
      <td style="text-align:left">@8:00pm EST every Monday</td>
      <td style="text-align:left">
        <p>Start a program:</p>
        <p>C:\Scripts\DeleteExpiredCerts\delete_expired.bat</p>
      </td>
    </tr>
    <tr>
      <td style="text-align:left">ptc-wbcrtapp701</td>
      <td style="text-align:left">Backup-CA to FTC-WCICERT401</td>
      <td style="text-align:left">
        <p>MDYNYCMAS\</p>
        <p>sys_cert_monitor</p>
      </td>
      <td style="text-align:left">@10:00pm EST every day</td>
      <td style="text-align:left">
        <p>Start a program:</p>
        <p>C:\Scripts\BACKUP-CA.bat</p>
      </td>
    </tr>
  </tbody>
</table>

Table 8 - Enterprise Subordinate CA Scheduled Tasks

The first one named Delete Expired Certs which is running once every week on Mondays is deleting all issued certificates which have expired more than a month ago from the current date.

_Set objShell = WScript.CreateObject\("WSCript.shell"\)_

_NewDate = DateAdd\("d", -30, date\(\)\)_

_Wscript.Echo NewDate_

_strcommand= "cmd /c c:\windows\system32\certutil -deleterow "& NewDate &" cert"_

_Wscript.Echo strcommand_

_objShell.Run strcommand_

The second task named Backup-CA is running on an everyday basis and is performing a backup of the certification authority and transferring it over the network to the designated DR server counterpart FTC-WCICERT401.

_certutil -backup -p &lt;pwdremoved&gt; -f -gmt -seconds -v \\ftc-wciscert401\e$\CA-Daily\_Backup_

## Additional Information

This section identifies related documents and the process to request updates to this document.

### Exceptions

Only the NTT Data Customer Executive or Moody's Representative may request changes or exceptions to the Moody's Policies and Procedures Manual.

### Modification Information and Contacts

To request a modification to this policy/procedure, and such modification does not modify the Agreement, please follow the procedure detailed in the document titled, "Governance" located in Section 3.2 of the Policies and Procedures Manual.

### Cross-Reference and Related Documents and Policies

Related policy and procedure documents as part of the policy and procedures manual are referenced in this section, including any references made to other documentation not included in the manual.

| Document Number | Document Title | Effective Year | Document Location \(url\) |
| :--- | :--- | :--- | :--- |
|  |  |  |  |
|  |  |  |  |
|  |  |  |  |

### Keywords

Microsoft PKI, ADCS, Certification Authority, Certificate

### Terms and Definitions

General terms and definitions pertaining to all NTT Data Moody’s policies and procedure are listed in the document “_3.32 Glossary of Key Terms and Definitions.”_

The following are terms and definitions specific to this policy/procedure.

### Practice Change and Revision

This document may be revised at the request of Moody’s or NTT Data in accordance with the Governance Policy of the Policies and Procedures Manual or as otherwise set forth in the Agreement. For the avoidance of doubt, it is not intended that modifications to this Policies and Procedures Manual will modify the Agreement. In the event such proposed modification alters, in any way, the terms and conditions of the Agreement, the Parties will mutually agree, in writing, to a formal amendment to the Agreement. Such Amendment may only be authorized by the NTT Data Customer Executive and Moody’s Representative after all appropriate financial and legal approvals have been obtained.

### Continuous Improvement

The procedure defined in this document is subject to regular review based on input from NTT Data team members.

